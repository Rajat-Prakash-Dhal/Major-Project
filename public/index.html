<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cyberthreat Mitigation - An n8n Approach</title>
  <style>
    /* (kept your existing styles, only slight layout tweak for the new filter control) */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
    .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
    header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2rem; margin-bottom: 2rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    header p { opacity: 0.9; font-size: 1rem; }

    .status-bar { background: white; padding: 1rem 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); flex-wrap: wrap; gap: 1rem; }

    .status-item { display:flex; align-items:center; gap:0.5rem; }
    .status-dot { width:10px; height:10px; border-radius:50%; background:#10b981; animation:pulse 2s infinite; }
    .status-dot.disconnected { background:#ef4444; }
    @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.5;} }

    .controls { background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display:flex; align-items:center; gap:1rem; flex-wrap:wrap; }
    .search-wrapper { display:flex; gap:0.5rem; align-items:center; flex:1; min-width:220px;}
    .search-box { width:100%; padding:0.75rem 1rem; border:2px solid #e2e8f0; border-radius:6px; font-size:1rem; transition:border-color 0.2s; }
    .search-box:focus { outline:none; border-color:#667eea; }

    /* new filter select styling */
    .filter-select { padding:0.6rem 0.8rem; border-radius:6px; border:2px solid #e2e8f0; font-size:0.95rem; background:white; cursor:pointer; }
    .filter-select:focus { outline:none; border-color:#667eea; }

    .auth-notice { background:#fef3c7; border:2px solid #fbbf24; padding:1.5rem; border-radius:8px; margin-bottom:1.5rem; text-align:center; }
    .auth-notice h3 { color:#92400e; margin-bottom:0.5rem; }
    .btn { background:#667eea; color:white; padding:0.75rem 1.5rem; border:none; border-radius:6px; font-size:1rem; cursor:pointer; transition:background 0.2s; text-decoration:none; display:inline-block; }
    .btn:hover { background:#5568d3; }
    .btn-small { padding:0.5rem 1rem; font-size:0.875rem; }
    .btn-secondary { background:#64748b; }
    .table-container { background:white; border-radius:8px; overflow:hidden; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
    table { width:100%; border-collapse:collapse; }
    thead { background:#f1f5f9; }
    th { padding:1rem; text-align:left; font-weight:600; color:#475569; font-size:0.875rem; text-transform:uppercase; letter-spacing:0.05em; }
    tbody tr { border-top:1px solid #e2e8f0; transition:background 0.2s; }
    tbody tr:hover { background:#f8fafc; }
    td { padding:1rem; font-size:0.875rem; }
    .badge { display:inline-block; padding:0.25rem 0.75rem; border-radius:12px; font-size:0.75rem; font-weight:600; text-transform:uppercase; }
    .badge.pending { background:#dbeafe; color:#1e40af; }
    .badge.scanning { background:#fef3c7; color:#92400e; }
    .badge.clean { background:#d1fae5; color:#065f46; }
    .badge.infected { background:#fee2e2; color:#991b1b; }
    .file-name { font-weight:500; color:#1e293b; display:flex; align-items:center; gap:0.5rem; }
    .file-icon { font-size:1.25rem; }
    .file-size { color:#64748b; }
    .actions { display:flex; gap:0.5rem; }
    .empty-state { text-align:center; padding:4rem 2rem; color:#64748b; }
    .empty-state-icon { font-size:4rem; margin-bottom:1rem; opacity:0.5; }

    @media (max-width:768px) {
      .controls { flex-direction:column; align-items:stretch; }
      .search-wrapper { width:100%; }
      .filter-select { width:100%; }
      .actions { flex-direction:column; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üìÅ Google Drive Folder Monitor</h1>
      <p>Real-time monitoring with automatic updates every 15 seconds</p>
    </header>

    <div class="status-bar">
      <div class="status-item">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Connecting...</span>
      </div>
      <div class="stats">
        <span id="fileCount">0 files</span>
        <span>‚Ä¢</span>
        <span id="lastUpdate">Never updated</span>
      </div>
    </div>

    <div id="authNotice" class="auth-notice" style="display:none;">
      <h3>‚ö† Authorization Required</h3>
      <p>Please authorize the app to access your Google Drive folder</p>
      <a href="/auth" class="btn">Authorize with Google</a>
    </div>

    <div class="controls">
      <div class="search-wrapper">
        <input id="searchBox" type="text" class="search-box" placeholder="üîç Search files by name..." />
      </div>

      <!-- New filter select placed beside the search box -->
      <select id="filterSelect" class="filter-select" title="Filter files by scan status">
        <option value="all">All files</option>
        <option value="clean">Clean</option>
        <option value="infected">Infected</option>
      </select>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Status</th>
            <th>Filename</th>
            <th>Type</th>
            <th>Size</th>
            <th>Modified</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="fileTableBody">
          <tr>
            <td colspan="6" class="empty-state">
              <div class="empty-state-icon">üìÇ</div>
              <p>Loading files...</p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/client.js"></script>
</body>
</html>
